<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(4)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > ul > li:nth-child(4) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > ul > li:nth-child(4) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(4) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>CPP Code Style | Apache Gluten incubating</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="CPP Code Style" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Gluten is a middle layer responsible for offloading JVM-based SQL engines’ execution to native engines." /> <meta property="og:description" content="Gluten is a middle layer responsible for offloading JVM-based SQL engines’ execution to native engines." /> <link rel="canonical" href="https://gluten.apache.org/docs/developers/cpp-code-style/" /> <meta property="og:url" content="https://gluten.apache.org/docs/developers/cpp-code-style/" /> <meta property="og:site_name" content="Apache Gluten incubating" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="CPP Code Style" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Gluten is a middle layer responsible for offloading JVM-based SQL engines’ execution to native engines.","headline":"CPP Code Style","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://gluten.apache.org/assets/images/gluten-logo-blue.png"}},"url":"https://gluten.apache.org/docs/developers/cpp-code-style/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Apache Gluten incubating"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Documentations category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/" class="nav-list-link">Documentations</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Getting-Started category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/getting-started/" class="nav-list-link">Getting-Started</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/getting-started/velox-backend/" class="nav-list-link">Getting Start with Velox Backend</a></li><li class="nav-list-item"><a href="/docs/getting-started/clickhouse-backend/" class="nav-list-link">Getting start with ClickHouse Backend</a></li><li class="nav-list-item"><a href="/docs/getting-started/build-guide/" class="nav-list-link">Build Parameters for Velox Backend</a></li><li class="nav-list-item"><a href="/docs/getting-started/s3/" class="nav-list-link">Using S3 with Gluten</a></li><li class="nav-list-item"><a href="/docs/getting-started/gcs/" class="nav-list-link">Using GCS with Gluten</a></li><li class="nav-list-item"><a href="/docs/getting-started/abfs/" class="nav-list-link">Using ABFS with Gluten</a></li><li class="nav-list-item"><a href="/docs/getting-started/localcache/" class="nav-list-link">Velox Local Caching</a></li></ul></li><li class="nav-list-item"><a href="/docs/configuration/" class="nav-list-link">Configuration</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Developers category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developers/" class="nav-list-link">Developers</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/developers/how-to-use/" class="nav-list-link">How To Use Gluten</a></li><li class="nav-list-item"><a href="/docs/developers/new-to/" class="nav-list-link">New To Gluten</a></li><li class="nav-list-item"><a href="/docs/developers/microbenchmarks/" class="nav-list-link">Micro Benchmarks for Velox Backend</a></li><li class="nav-list-item"><a href="/docs/developers/cpp-code-style/" class="nav-list-link">CPP Code Style</a></li><li class="nav-list-item"><a href="/docs/developers/velox-function-dev/" class="nav-list-link">Velox Function Development</a></li><li class="nav-list-item"><a href="/docs/developers/docker-ubuntu/" class="nav-list-link">Docker script for Ubuntu 22.04/20.04</a></li><li class="nav-list-item"><a href="/docs/developers/docker-centos7/" class="nav-list-link">Docker script for CentOS 7</a></li><li class="nav-list-item"><a href="/docs/developers/docker-centos8/" class="nav-list-link">Docker script for CentOS 8</a></li><li class="nav-list-item"><a href="/docs/developers/substrait/" class="nav-list-link">Substrait Modifications</a></li><li class="nav-list-item"><a href="/docs/developers/how-to-release/" class="nav-list-link">How To Release</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Velox Backend category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/velox-backend/" class="nav-list-link">Velox Backend</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/velox-backend/support/" class="nav-list-link">Supported Operators & Functions</a></li><li class="nav-list-item"><a href="/docs/velox-backend/limitations/" class="nav-list-link">Limitations</a></li><li class="nav-list-item"><a href="/docs/velox-backend/troubleshooting/" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item"><a href="/docs/velox-backend/udf/" class="nav-list-link">Velox UDF</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Archives category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/archives/" class="nav-list-link">Archives</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in v1.1.1 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/archives/v1.1.1/" class="nav-list-link">v1.1.1</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in v1.1.1/Documentation category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/archives/v1.1.1/docs/" class="nav-list-link">v1.1.1/Documentation</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in v1.1.1/Velox Backend category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/archives/v1.1.1/docs/velox/" class="nav-list-link">v1.1.1/Velox Backend</a><ul class="nav-list"><li class="nav-list-item"><a href="/archives/v1.1.1/docs/velox/getting-started/" class="nav-list-link">v1.1.1/Getting-Started with Velox Backend</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/docs/velox/build_parameters/" class="nav-list-link">v1.1.1/Build Parameters for Velox Backend</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/docs/velox/s3/" class="nav-list-link">v1.1.1/Using S3 with Gluten</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/docs/velox/gcs/" class="nav-list-link">v1.1.1/Using GCS with Gluten</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in v1.1.1/ClickHouse Backend category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/archives/v1.1.1/docs/clickhouse/" class="nav-list-link">v1.1.1/ClickHouse Backend</a><ul class="nav-list"><li class="nav-list-item"><a href="/archives/v1.1.1/docs/clickhouse/getting-started/" class="nav-list-link">v1.1.1/Getting Started with ClickHouse Backend</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in v1.1.1/Developers category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/archives/v1.1.1/developers/" class="nav-list-link">v1.1.1/Developers</a><ul class="nav-list"><li class="nav-list-item"><a href="/archives/v1.1.1/developers/newto/" class="nav-list-link">v1.1.1/New To Gluten</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/howto/" class="nav-list-link">v1.1.1/How To Use Gluten</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/microbenchmark/" class="nav-list-link">v1.1.1/Micro Benchmarks for Velox Backend</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/cpp_code_style/" class="nav-list-link">v1.1.1/CPP Code Style</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/velox_function_development/" class="nav-list-link">v1.1.1/Velox Function Development</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/docker_ubuntu/" class="nav-list-link">v1.1.1/Docker script for Ubuntu 22.04/20.04</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/docker_centos8" class="nav-list-link">v1.1.1/Docker script for CentOS 8</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/docker_centos7/" class="nav-list-link">v1.1.1/Docker script for CentOS 7</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/substrait/" class="nav-list-link">v1.1.1/Substrait Modifications</a></li><li class="nav-list-item"><a href="/archives/v1.1.1/developers/howtorelease/" class="nav-list-link">v1.1.1/How To Release</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="/downloads/" class="nav-list-link">Downloads</a></li><li class="nav-list-item"><a href="/blog/" class="nav-list-link">Blog</a></li><li class="nav-list-item"><a href="/references/" class="nav-list-link">Gluten References</a></li><li class="nav-list-item"><a href="/contributing/" class="nav-list-link">Contributing to Gluten</a></li><li class="nav-list-item"><a href="/contact/" class="nav-list-link">Contact Us</a></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Apache Gluten incubating" aria-label="Search Apache Gluten incubating" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <style> /* Style The Dropdown Button */ .dropbtn { background-color: #0000ff80; color: white; padding: 22px; width: 100%; font-size: 14px; border: none; cursor: pointer; } /* The container <div> - needed to position the dropdown content */ .dropdown { position: relative; display: inline-block; } /* Dropdown Content (Hidden by Default) */ .dropdown-content { display: none; position: absolute; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; } /* Links inside the dropdown */ .dropdown-content a { color: black; padding: 12px 14px; text-decoration: none; display: block; } /* Change color of dropdown links on hover */ .dropdown-content a:hover {background-color: #f1f1f1} /* Show the dropdown menu on hover */ .dropdown:hover .dropdown-content { display: block; } /* Change the background color of the dropdown button when the dropdown content is shown */ .dropdown:hover .dropbtn { background-color: #0000ff; } </style> <!-- Collect the nav links, forms, and other content for toggling --> <div class="dropdown" id="apache-navbar" style="float:left;"> <button class="dropbtn">ASF</button> <div class="dropdown-content"> <a class="dropdown-item" href="https://www.apache.org/">Foundation</a> <a class="dropdown-item" href="https://www.apache.org/events/current-event.html">Event</a> <a class="dropdown-item" href="https://www.apache.org/licenses/">License</a> <a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a> <a class="dropdown-item" href="https://www.apache.org/security/">Security</a> <a class="dropdown-item" href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy</a> <a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a> </div> </div><!-- /.navbar-collapse --> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/apache/incubator-gluten" class="site-button" target="_blank" rel="noopener noreferrer" > Apache Gluten Github </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/">Documentations</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/developers/">Developers</a></li> <li class="breadcrumb-nav-list-item"><span>CPP Code Style</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="gluten-cpp-core-guidelines"> <a href="#gluten-cpp-core-guidelines" class="anchor-heading" aria-labelledby="gluten-cpp-core-guidelines"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gluten CPP Core Guidelines </h1> <p>This is a set of CPP core guidelines for Gluten. The aim is to make the codebase simpler, more efficient, more maintainable by promoting consistency and according to best practices.</p> <h2 id="philosophy"> <a href="#philosophy" class="anchor-heading" aria-labelledby="philosophy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Philosophy </h2> <p>Philosophical rules are generally not measurable. However, they are valuable. For Gluten CPP coding, there are a few Philosophical rules as the following.</p> <ul> <li>Write in ISO Standard C++.</li> <li>Standard API first, the CPP programming APIs are priority to system calls.</li> <li>Write code consistently. It’s good for understanding and maintaining.</li> <li>Keep simple, making code clear and easy to read.</li> <li>Optimize code for reader, not for writer. Thus, more time will be spent reading code than writing it.</li> <li>Make it work, and then make it better or faster.</li> <li>Don’t import any complexity if possible. Collaborate with minimal knowledge consensus.</li> </ul> <h2 id="code-formatting"> <a href="#code-formatting" class="anchor-heading" aria-labelledby="code-formatting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code Formatting </h2> <p>Many aspects of C++ coding style will be covered by clang-format, such as spacing, line width, indentation and ordering (for includes, using directives and etc). </p> <ul> <li>Always ensure your code is compatible with clang-format-12 for Velox backend.</li> <li><code class="language-plaintext highlighter-rouge">dev/formatcppcode.sh</code> is provided for formatting Velox CPP code.</li> </ul> <h2 id="naming-conventions"> <a href="#naming-conventions" class="anchor-heading" aria-labelledby="naming-conventions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Naming Conventions </h2> <ul> <li>Use <strong>PascalCase</strong> for types (class, struct, enum, type alias, type template parameter) and file name.</li> <li>Use <strong>camelCase</strong> for function, member and local variable, and non-type template parameter.</li> <li>Use <strong>camelCase_</strong> for private and protected member variable.</li> <li>Use <strong>snake_case</strong> for namespace name and build target.</li> <li>Use <strong>UPPER_SNAKE_CASE</strong> for macro.</li> <li>Use <strong>kPascalCase</strong> for static constant and enumerator.</li> </ul> <h2 id="designs"> <a href="#designs" class="anchor-heading" aria-labelledby="designs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Designs </h2> <ul> <li>No over design.</li> <li>No negation of negation, <code class="language-plaintext highlighter-rouge">isValid</code> is better than <code class="language-plaintext highlighter-rouge">isNotInvalid</code>.</li> <li>Avoid corner case, and common case first.</li> <li>Express ideas directly, don’t let me think.</li> <li>Make a check for the arguments in the interface between modules, and don’t make a check in the inner implementation, use <code class="language-plaintext highlighter-rouge">assert</code> in the private implementation instead of too much safe check.</li> </ul> <h2 id="source-file--header-file"> <a href="#source-file--header-file" class="anchor-heading" aria-labelledby="source-file--header-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Source File &amp; Header File </h2> <ul> <li>All header files must have a single-inclusion guard using <code class="language-plaintext highlighter-rouge">#pragma once</code></li> <li>Always use <code class="language-plaintext highlighter-rouge">.h</code> as header file suffix, not <code class="language-plaintext highlighter-rouge">.hpp</code>.</li> <li>Always use <code class="language-plaintext highlighter-rouge">.cc</code> as source file suffix, neither <code class="language-plaintext highlighter-rouge">.cpp</code> nor <code class="language-plaintext highlighter-rouge">.cxx</code>.</li> <li>One file should contain one main class, and the file name should be consistent with the main class name. <ul> <li>Obvious exception: files used for defining various misc functions.</li> </ul> </li> <li>If a header file has a corresponding source file, they should have the same file name with different suffix, such as <code class="language-plaintext highlighter-rouge">a.h vs a.cc</code>.</li> <li>If a function is declared in the file <code class="language-plaintext highlighter-rouge">a.h</code>, ensure it’s defined in the corrosponding source file <code class="language-plaintext highlighter-rouge">a.cc</code>, do not define it in other files.</li> <li>No deep source directory for CPP files, not do it as JAVA.</li> <li>Include header files should satisfy the following rules. <ul> <li>Include the necessary header files, which means the source file (.cc) containing the only one line <code class="language-plaintext highlighter-rouge">#include "test.h"</code> can be compiled successfully without including any other header files.</li> <li>Do not include any unnecessary header files, the more including, the slower compiling.</li> <li>In one word, no more, no less, just as needed.</li> </ul> </li> </ul> <h2 id="class"> <a href="#class" class="anchor-heading" aria-labelledby="class"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Class </h2> <ul> <li>Base class name doesn’t end with Base, use <code class="language-plaintext highlighter-rouge">Backend</code> instead of <code class="language-plaintext highlighter-rouge">BackendBase</code>.</li> <li>Ensure one class does one thing, and follows the single responsibility principle.</li> <li>No big class, No huge class, No too much interfaces.</li> <li>Distinguish interface from implementation, make implementations private.</li> <li>When designing a class hierarchy, distinguish between interface inheritance and implementation inheritance. <ul> <li>Ensure that public inheritance represent the relation of <code class="language-plaintext highlighter-rouge">is-a</code>.</li> <li>Ensure that private inheritance represent the relation of <code class="language-plaintext highlighter-rouge">implements-with</code>.</li> </ul> </li> <li>Don’t make a function <code class="language-plaintext highlighter-rouge">virtual</code> without reason.</li> <li>Ensure the polymorphic base class has a <code class="language-plaintext highlighter-rouge">virtual</code> deconstructor.</li> <li>Use <code class="language-plaintext highlighter-rouge">override</code> to make overriding explicit and to make the compiler work.</li> <li>Use <code class="language-plaintext highlighter-rouge">const</code> to mark the member function read-only as far as possible.</li> <li>When you try to define a <code class="language-plaintext highlighter-rouge">copy constructor</code> or a <code class="language-plaintext highlighter-rouge">operator=</code> for a class, remember the <code class="language-plaintext highlighter-rouge">Rule of three/five/zero</code>.</li> </ul> <h2 id="function"> <a href="#function" class="anchor-heading" aria-labelledby="function"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Function </h2> <ul> <li>Make functions short and simple.</li> <li>Calling a meaningful function is more readable than writing too many statements in place, but the performance-sensitive code path is an exception.</li> <li>Give the function a good name, how to check whether the function name is good or not. <ul> <li>When you read it loudly, you feel smooth.</li> <li>The information can be represented by arguments should not be encoded into the function name. such as. use <code class="language-plaintext highlighter-rouge">get(size_t index)</code> instead of <code class="language-plaintext highlighter-rouge">getByIndex</code>.</li> </ul> </li> <li>A function should focus on a single logic operation.</li> <li>A function should do as the name meaning. <ul> <li>do everything converd by the function name</li> <li>don’t do anything not convered by the function name</li> </ul> </li> </ul> <h2 id="variable"> <a href="#variable" class="anchor-heading" aria-labelledby="variable"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Variable </h2> <ul> <li>Make variable names simple and meaningful.</li> <li>Don’t group all your variables at the top of the scope, it’s an outdated habit.</li> <li>Declare variables as close to the usage point as possible.</li> </ul> <h2 id="constant"> <a href="#constant" class="anchor-heading" aria-labelledby="constant"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Constant </h2> <ul> <li>Prefer const variables to using preprocessor (<code class="language-plaintext highlighter-rouge">#define</code>) to define constant values.</li> </ul> <h2 id="macro"> <a href="#macro" class="anchor-heading" aria-labelledby="macro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Macro </h2> <ul> <li>Macros downgrade readability, break mind, and affect debug.</li> <li>Macros have side effects.</li> <li>Use macros cautiously and carefully.</li> <li>Consider using <code class="language-plaintext highlighter-rouge">const</code> variables or <code class="language-plaintext highlighter-rouge">inline</code> functions to replace macros.</li> <li>Consider defining macros with the wrap of <code class="language-plaintext highlighter-rouge">do {...} while (0)</code></li> <li>Avoid using 3rd party library macros directly.</li> </ul> <h2 id="namespace"> <a href="#namespace" class="anchor-heading" aria-labelledby="namespace"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Namespace </h2> <ul> <li>Don’t <code class="language-plaintext highlighter-rouge">using namespace xxx</code> in header files. Instead, you can do this in source files. But it’s still not encouraged.</li> <li>Place all Gluten CPP codes under <code class="language-plaintext highlighter-rouge">namespace gluten</code> because one level namespace is enough. No nested namespace. Nested namespaces bring mess.</li> <li>The anonymous namespace is recommended for defining file level classes, functions and variables. It’s used to place file scoped static functions and variables.</li> </ul> <h2 id="resource-management"> <a href="#resource-management" class="anchor-heading" aria-labelledby="resource-management"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resource Management </h2> <ul> <li>Use handles and RAII to manage resources automatically.</li> <li>Immediately give the result of an explicit resource allocation to a manager object.</li> <li>Prefer scoped objects and stack objects.</li> <li>Use raw pointers to denote individual objects.</li> <li>Use <code class="language-plaintext highlighter-rouge">pointer + size_t</code> to denote array objects if you don’t want to use containers.</li> <li>A raw pointer (a <code class="language-plaintext highlighter-rouge">T*</code>) is non-owning.</li> <li>A raw reference (a <code class="language-plaintext highlighter-rouge">T&amp;</code>) is non-owning.</li> <li>Understand the difference of <code class="language-plaintext highlighter-rouge">unique_ptr</code>, <code class="language-plaintext highlighter-rouge">shared_ptr</code>, <code class="language-plaintext highlighter-rouge">weak_ptr</code>. <ul> <li><code class="language-plaintext highlighter-rouge">unique_ptr</code> represents ownership, but not share ownership. <code class="language-plaintext highlighter-rouge">unique_ptr</code> is equivalent to RAII, release the resource when the object is destructed.</li> <li><code class="language-plaintext highlighter-rouge">shared_ptr</code> represents shared ownership by use-count. It is more expensive that <code class="language-plaintext highlighter-rouge">unqiue_ptr</code>.</li> <li><code class="language-plaintext highlighter-rouge">weak_ptr</code> models temporary ownership. It is useful in breaking reference cycles formed by objects managed by <code class="language-plaintext highlighter-rouge">shared_ptr</code>.</li> </ul> </li> <li>Use <code class="language-plaintext highlighter-rouge">unique_ptr</code> or <code class="language-plaintext highlighter-rouge">shared_ptr</code> to represent ownership.</li> <li>Prefer <code class="language-plaintext highlighter-rouge">unique_ptr</code> over <code class="language-plaintext highlighter-rouge">shared_ptr</code> unless you need to share ownership.</li> <li>Use <code class="language-plaintext highlighter-rouge">make_unique</code> to make <code class="language-plaintext highlighter-rouge">unique_ptr</code>s.</li> <li>Use <code class="language-plaintext highlighter-rouge">make_shared</code> to make <code class="language-plaintext highlighter-rouge">shared_ptr</code>s.</li> <li>Take smart pointers as parameters only to explicitly express lifetime semantics.</li> <li><strong>For general use</strong>, take <code class="language-plaintext highlighter-rouge">T*</code> or <code class="language-plaintext highlighter-rouge">T&amp;</code> arguments rather than smart pointers.</li> </ul> <h2 id="exception"> <a href="#exception" class="anchor-heading" aria-labelledby="exception"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exception </h2> <ul> <li>The exception specifications are changing always. The difference between various CPP standards is big, so we should use exception cautiously in Gluten.</li> <li>Prefer <code class="language-plaintext highlighter-rouge">return code</code> to throwing exceptions.</li> <li>Prefer compile-time checking to run-time checking.</li> <li>Encapsulate messy constructors, rather than spreading through the code.</li> </ul> <h2 id="code-comment"> <a href="#code-comment" class="anchor-heading" aria-labelledby="code-comment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code Comment </h2> <ul> <li>Add necessary comments. The comment is not the more the better, also not the less the better.</li> <li>Good comment makes obscure code easily understood. It’s unnecessary to add comments for quite obvious code.</li> </ul> <h2 id="references"> <a href="#references" class="anchor-heading" aria-labelledby="references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h2> <ul> <li><a href="https://github.com/fluz/CppCoreGuidelines">CppCoreGuidelines</a></li> <li><a href="https://github.com/facebookincubator/velox/blob/main/CODING_STYLE.md">Velox CODING_STYLE</a></li> <li>Thanks Gluten developers for their wise suggestions and helps.</li> </ul> </main> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <a href="https://incubator.apache.org/"><img src="/assets/images/apache-incubator.svg" style="width:300px"></a> <p class="text-small text-grey-dk-100 mb-0">Copyright © 2024 The Apache Software Foundation, Licensed under the Apache License, Version 2.0. Apache Gluten, Gluten, Apache, the Apache feather logo, and the Apache Gluten project logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</p> <p class="text-small text-grey-dk-100 mb-0">Apache Gluten is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p> <p class="text-small text-grey-dk-100 mb-0"><a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
